# BookSearchCommand.java
```
package first;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class BookSearchCommand {
    public static void main(String[] args) {
        // 사용할 자원 null로 초기화
        Connection con = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;
        try {
            // [1단계] JDBC Driver 로딩
            Class.forName("oracle.jdbc.driver.OracleDriver");
            System.out.println("MySQL Driver Loading 성공!");
            // [2단계] DB 연결
            String jdbcURL = "jdbc:oracle:thin:@localhost:1521:xe";
            String ID = "C##2";
            String PW = "1234";
            con = DriverManager.getConnection(jdbcURL, ID, PW);
            // 기본적으로 autoCommnit mode로 Connection이 생성
            // con.setAutoCommit(false); // -> Transaction 시작 설정
            System.out.println("데이터베이스 연결 성공!");
            // [3단계] SQL 작성
            // IN Parameter를 사용해서 query를 작성
            String keyword = "여행";
            String sql = "select bisbn, btitle, bauthor, bprice" +
                        " from book where btitle like ?";
            // 코드 작성하기 편하고, 효율과 보안이 좋은 PreparedStatement로 sql 작성
            pstmt = con.prepareStatement(sql);
            pstmt.setString(1, "%" + keyword + "%");
            // [4단계] Query 실행
            rs = pstmt.executeQuery();
            // [5단계] 결과 처리
            while (rs.next()) {
                String tmp = "";
                tmp += rs.getString("bisbn") + " ";
                tmp += rs.getString("btitle") + " ";
                tmp += rs.getString("bauthor") + " ";
                tmp += rs.getInt("bprice") + " ";
                System.out.println(tmp);
            }
            // con.commit();    // -> Transaction을 적용하며 명시적으로 끝냄
            // con.rollback();  // -> Transaction을 적용하지 않으며 명시적으로 끝냄
        } catch(Exception e) {
            System.out.println(e);
        } finally {
            try {
                // [6단계] 리소스 해제
                // 자원의 생성 순서의 반대로 할당을 해제한다.
                rs.close();
                pstmt.close();
                if (con != null)
                    con.close();
                System.out.println("connection close()");
            } catch(Exception e2) {
                System.out.println(e2);
            }
        }
    }
}
```

# TransactionTest.java (수업)
```
package first;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;

public class TransactionTest {
    public static void main(String[] args) {
        // 기본적인 JDBC 코드를 생성
        Connection con = null;
        try {
            // 1. Driver Loading
            Class.forName("oracle.jdbc.driver.OracleDriver");
            // 2. Connection 연결
            String URL = "jdbc:oracle:thin:@localhost:1521:xe";
            String id = "C##2";
            String pw = "1234";
            con = DriverManager.getConnection(URL, id, pw);
            // 기본적으로 autoCommit mode로 Connection이 생성
            // 만약 Transaction을 설정하려면
            con.setAutoCommit(false); // Transaction 시작
            // 명시적으로 con.commit() 혹은 con.rollback()이 호출되면 Transaction이 종료된다.
            // +)해당 구문이 나오지 않고 connection이 정상종료되면 con.commit()으로 간주
            // 3. SQL 구문 작성
            String sql = "INSERT into MEMBERTBL values(?,?)";
            PreparedStatement pstmt = con.prepareStatement(sql);
            pstmt.setString(1, "1");
            pstmt.setString(2, "홍길동");

            // 4. SQL 구문 실행
            int result = pstmt.executeUpdate(); // return 값은 영향받은 row의 수
            // 5. 결과처리
            if (result == 1) {
                System.out.println("잘 처리되었어요!");
            }
            // 6. 리소스 해제
            pstmt.close();
            con.close();
        } catch(Exception e) {
            e.printStackTrace();
        }
    }
}
```
