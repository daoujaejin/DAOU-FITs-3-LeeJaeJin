# boxOfficeAjax.html
```
<!doctype html>
<html lang="en" data-bs-theme="auto">
<head>

  <meta charset="utf-8">
  <title>Daily BoxOffice 순위 조회</title>
  <!-- jQuery CHN -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="js/boxOfficeAjax.js"></script>
  <!-- Bootstrap CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }

    .b-example-divider {
      width: 100%;
      height: 3rem;
      background-color: rgba(0, 0, 0, .1);
      border: solid rgba(0, 0, 0, .15);
      border-width: 1px 0;
      box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
    }

    .b-example-vr {
      flex-shrink: 0;
      width: 1.5rem;
      height: 100vh;
    }

    .bi {
      vertical-align: -.125em;
      fill: currentColor;
    }

    .nav-scroller {
      position: relative;
      z-index: 2;
      height: 2.75rem;
      overflow-y: hidden;
    }

    .nav-scroller .nav {
      display: flex;
      flex-wrap: nowrap;
      padding-bottom: 1rem;
      margin-top: -1px;
      overflow-x: auto;
      text-align: center;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
    }

    .btn-bd-primary {
      --bd-violet-bg: #712cf9;
      --bd-violet-rgb: 112.520718, 44.062154, 249.437846;

      --bs-btn-font-weight: 600;
      --bs-btn-color: var(--bs-white);
      --bs-btn-bg: var(--bd-violet-bg);
      --bs-btn-border-color: var(--bd-violet-bg);
      --bs-btn-hover-color: var(--bs-white);
      --bs-btn-hover-bg: #6528e0;
      --bs-btn-hover-border-color: #6528e0;
      --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
      --bs-btn-active-color: var(--bs-btn-hover-color);
      --bs-btn-active-bg: #5a23c8;
      --bs-btn-active-border-color: #5a23c8;
    }

    .bd-mode-toggle {
      z-index: 1500;
    }

    .bd-mode-toggle .dropdown-menu .active .bi {
      display: block !important;
    }
  </style>

  <!-- Custom styles for this template -->
  <link href="css/dashboard.css" rel="stylesheet">

</head>
<body>







<header class="navbar sticky-top bg-dark flex-md-nowrap p-0 shadow" data-bs-theme="dark">
  <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6 text-white" href="#">일일 박스오피스 순위조회</a>

  <ul class="navbar-nav flex-row d-md-none">
    <li class="nav-item text-nowrap">
      <button class="nav-link px-3 text-white" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSearch" aria-controls="navbarSearch" aria-expanded="false" aria-label="Toggle search">
        <svg class="bi"><use xlink:href="#search"/></svg>
      </button>
    </li>
    <li class="nav-item text-nowrap">
      <button class="nav-link px-3 text-white" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
        <svg class="bi"><use xlink:href="#list"/></svg>
      </button>
    </li>
  </ul>

  <div id="navbarSearch" class="navbar-search w-100 collapse">
    <input class="form-control w-100 rounded-0 border-0" type="text" placeholder="Search" aria-label="Search">
  </div>
</header>

<input type="date">
<input type="button" value="검색" onclick="myFunc()">

<div class="container-fluid">
  <div class="row">
    <div class="sidebar border border-right col-md-3 col-lg-2 p-0 bg-body-tertiary">
      <div class="offcanvas-md offcanvas-end bg-body-tertiary" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="sidebarMenuLabel">Company name</h5>
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#sidebarMenu" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body d-md-flex flex-column p-0 pt-lg-3 overflow-y-auto">
          <ul class="nav flex-column">
          </ul>

          <ul class="nav flex-column mb-auto">
          </ul>


          <ul class="nav flex-column mb-auto">
          </ul>
        </div>
      </div>
    </div>

    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">



      <h2>조회 결과</h2>
      <div class="table-responsive small">
        <table class="table table-striped table-sm">
          <thead>
          <tr>
            <th scope="col">순위</th>
            <th scope="col">영화 포스터</th>
            <th scope="col">영화 제목</th>
            <th scope="col">누적 관객수</th>
            <th scope="col">영화 개봉일</th>
            <th scope="col">삭제 버튼</th>
          </tr>
          </thead>
          <tbody>
          <tr>
<!--            <td>1</td>-->
<!--            <td>이미지</td>-->
<!--            <td>에이리언</td>-->
<!--            <td>2000</td>-->
<!--            <td>2025-01-01</td>-->
<!--            <td><input type="button" value="삭제"></td>-->
          </tr>
          </tbody>
        </table>
      </div>
    </main>
  </div>
</div>
</html>
```
# boxOfficeAjax.js
```
// function myFunc() {
//     const REST_API_KEY = "795efba755c60022dea356bbe8ace1bb";
//     // 버튼 클릭하면 실행
//     $("tbody").empty();
//
//     // jQuery로 AJAX 호출 실행
//     // 어떤 API를 호출할지, GET방식인지, POST방식인지, 파라미터는 어떤건지, ...
//     // 이 정보들을 JavaScript 객체로 만들어서 사용한다.
//     $.ajax({
//         async: true, // 비동기 / 동기 방식 선택 (기본값은 비동기)
//         url: "http://www.kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json",
//         type: "GET",
//         data: {
//             key: "6a88e9c71125c3650d91c7b20990fdae",
//             targetDt: "20250218"
//         },
//         dataType: "json", // 서버가 보내주는 결과데이터가 JSON이라는 것을 의미
//         success: function(rankResult) {
//             const movieList = rankResult.boxOfficeResult.dailyBoxOfficeList.sort((a, b) => {
//                 return parseInt(a.rank) - parseInt(b.rank);
//             });
//
//             $.each(movieList, function(index, movie) {
//                 const movieName = movie.movieNm;
//                 const movieRank = movie.rank;
//                 const moviePeople = movie.audiAcc;
//                 const movieOpenDate = movie.openDt;
//
//                 // 카카오 이미지 검색 API 호출
//                 $.ajax({
//                     async: true,
//                     url: "https://dapi.kakao.com/v2/search/image",
//                     headers: {
//                         Authorization: `KakaoAK ${REST_API_KEY}`
//                     },
//                     type: "GET",
//                     data: {
//                         query: movieName, // 검색어로 영화 제목 사용
//                         sort: "accuracy", // 정렬 기준 (정확도순)
//                         page: 1, // 페이지 번호
//                         size: 1 // 한 개의 이미지만 가져옴
//                     },
//                     dataType: "json",
//                     success: function(imageResult) {
//                         const imageUrl = imageResult.documents[0].thumbnail_url;
//
//                         // <tbody>에 새로운 행 추가
//                         const newRow = `
//                             <tr>
//                                 <td>${movieRank}</td>
//                                 <td><img src="${imageUrl}" alt="${movieName}" style="width: 50px; height: auto;"></td>
//                                 <td>${movieName}</td>
//                                 <td>${moviePeople}</td>
//                                 <td>${movieOpenDate}</td>
//                                 <td><input type="button" value="삭제" onclick="deleteRow(this)"></td>
//                             </tr>
//                         `;
//                         $("tbody").append(newRow);
//                     },
//                     error: function() {
//                         console.error(`카카오 이미지 검색 실패 (영화 제목: ${movieName})`);
//                     }
//                 });
//             });
//         },
//         error: function() {
//             alert("영화진흥원 API 호출 오류!");
//         }
//     })
// }

function myFunc() {
    const REST_API_KEY = "795efba755c60022dea356bbe8ace1bb"; // 카카오 REST API 키

    // <tbody> 초기화
    $("tbody").empty();

    // 영화진흥위원회 API 호출
    $.ajax({
        async: true,
        url: "http://www.kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json",
        type: "GET",
        data: {
            key: "6a88e9c71125c3650d91c7b20990fdae", // 영화진흥위원회 API 키
            targetDt: "20250218" // 조회할 날짜 (YYYYMMDD 형식)
        },
        dataType: "json",
        success: function(rankResult) {
            // 영화 데이터를 가져온 후 rank(순위) 기준으로 오름차순 정렬
            const movieList = rankResult.boxOfficeResult.dailyBoxOfficeList.sort((a, b) => {
                return parseInt(a.rank) - parseInt(b.rank); // rank 값을 숫자로 변환하여 비교
            });

            // 모든 영화 데이터를 처리한 후 최종적으로 <tbody> 업데이트
            const promises = $.map(movieList, function(movie) {
                const movieName = movie.movieNm;
                const movieRank = movie.rank;
                const moviePeople = movie.audiAcc;
                const movieOpenDate = movie.openDt;

                // 카카오 이미지 검색 API 호출 (Promise로 감싸기)
                return $.ajax({
                    async: true,
                    url: "https://dapi.kakao.com/v2/search/image",
                    headers: {
                        Authorization: `KakaoAK ${REST_API_KEY}`
                    },
                    type: "GET",
                    data: {
                        query: movieName + " 포스터", // 검색어로 영화 제목 사용
                    },
                    dataType: "json"
                }).then(function(imageResult) {
                    const imageUrl = imageResult.documents.length > 0 ? imageResult.documents[0].thumbnail_url : "";

                    return `
                        <tr>
                            <td>${movieRank}</td>
                            <td><img src="${imageUrl}" alt="${movieName}" style="width: 50px; height: auto;"></td>
                            <td>${movieName}</td>
                            <td>${moviePeople}</td>
                            <td>${movieOpenDate}</td>
                            <td><input type="button" value="삭제" onclick="deleteRow(this)"></td>
                        </tr>
                    `;
                });
            });

            // 모든 비동기 작업 완료 후 <tbody> 업데이트
            $.when.apply($, promises).done(function(...rows) {
                $("tbody").append(rows);
            });
        },
        error: function() {
            alert("영화진흥원 API 호출 오류!");
        }
    });
}

// 삭제 버튼 클릭 시 해당 행 삭제
function deleteRow(button) {
    $(button).closest("tr").remove();
}
```
